import{a as ue,_ as le,B as W,C as X,e as Z,P as ee,h as te,f as fe,g as he,D as me,E as pe,I as _e,u as de,d as r,r as z,b as g,w as B,l as c,p as q,t as ce,v as d,x,A as I,j as i,H as P,z as N,y as _,J as re,T as ge,m as G,i as K,M as De,k as ye,a0 as ke,a1 as Me,a2 as ve,q as ae,F as ne,n as Ce,a3 as Q,s as we,K as be}from"./index-ea1c0221.js";import{V as oe,B as se,a as Oe,b as xe}from"./vue-draggable-next.esm-bundler-60884a9a.js";import{c as ie,s as Ie,M as Se,a as Ye}from"./utils-61e8505b.js";const Ee=ue({name:"dailycard",components:{BarsOutlined:W,draggable:oe,CheckOutlined:X,CloseOutlined:Z,BorderOutlined:se,PlusSquareOutlined:ee,PlusOutlined:te,BarsOutlined:W,draggable:oe,CheckOutlined:X,CloseOutlined:Z,BorderOutlined:se,PlusSquareOutlined:ee,CheckCircleOutlined:fe,CloseCircleOutlined:he,DeleteOutlined:me,EditOutlined:pe,VerticalRightOutlined:Oe,VerticalLeftOutlined:xe,Input:_e,PlusOutlined:te},props:{carddate:{type:String,required:!0},toDay:{type:String}},setup(u){const a=de(),{carddate:k,toDay:f}=u;let y=r(k,"MM/DD-[星期]dd").unix()*1e3,n=z([]),C=g(!0),D=z({item:[]});const w=g(null);a.actions.getAllData().then(e=>{C.value=!0;const t=z([]);t.unshift(...e),t.forEach((o,l)=>{let m=JSON.parse(t[l].allMes).magName;JSON.parse(t[l].allMes).item.forEach(F=>{F.magName=m,D.item.unshift(F)})}),D.item.forEach(o=>{r(y).isSame(o.time,"day")&&(o.checked==!1&&n.unshift(o),o.checked==!0&&n.push(o))}),n.sort(L),C.value=!1});const S=g(!1);B(()=>a.state.magName,e=>{const t={magName:e,item:[]};n.push(t),a.state.applists=e}),a.actions.getAllData().then(e=>{const t=z([]);t.unshift(...e),t.forEach((o,l)=>{let m=JSON.parse(t[l].allMes).item;D.item.unshift(...m)})});const E=z({card_title:"全部"});B(a.state.sionData,e=>{a.state.sionData.length!==0&&r(y).isSame(e[1].time,"day")&&(n.unshift(e[1]),a.state.sionData.splice(0,a.state.sionData.length))});function L(e,t){if(e.checked==!1)return t.time-e.time}let Y=g(!1);const T=g(!1);let h=g(!1);function M(e){Y=!0,console.log(e)}function b(){Y=!1}const p=()=>{a.state.addCardVisible=!0,console.log("store.state.addCardVisible:",a.state.addCardVisible)};async function $(e){let t=0;e.checked===!0?n.forEach((o,l)=>{if(o.id===e.id)throw console.log("data[e]:",n[l]),a.actions.putItemChecked(n[l],e),n.splice(l,1),e.timeTrue=Date.now(),n.push(e),n.forEach(m=>{m.checked===!1&&t++}),t?G.success(`Nice！！！${k} 只剩${t}项待办事件啦！加油加油！`):G.success(`耶！关于${k} 的任务全部完成咯！！！`)}):n.forEach((o,l)=>{o.id===e.id&&(a.actions.putItemChecked(n[l],e),n.splice(l,1),n.unshift(e))})}function H(e,t){return t!==void 0&&t!==""?`${K(t).format("YY/MM/DD-HH:mm")} 至 ${K(e).format("YY/MM/DD-HH:mm")}`:K(e).format("YY/MM/DD-HH:mm")}function A(e){e.checked=!0}function U(e){n.forEach((t,o)=>{t===e&&n.splice(o,1)})}function s(){n.forEach(e=>{e.checked==!1})}function O(e){console.log("item:",e.magName),a.state.itemVisible=!0,a.state.ListMagName=e.magName,a.state.doubleClickItem=e}B(()=>a.state.BtndelItem,e=>{r(y).isSame(e.time,"day")&&J(e)}),B(a.state.sionListValue,e=>{n.forEach((t,o)=>{t.id===e.cardItem.id&&(n[o].magName=e.sionList,console.log("data[index]:",n[o]),a.actions.changeListItem(e))})}),B(a.state.changeItemMegArr,e=>{let t=r(e.ItemMeg.time).format("YYYY-MM-DD"),o=r(e.oldItemMeg.time).format("YYYY-MM-DD");if(t===o)r(y).isSame(e.ItemMeg.time,"day")&&n.forEach((m,v)=>{m.id===e.ItemMeg.id&&(n[v]=e.ItemMeg)});else{const l=r(y).isSame(e.oldItemMeg.time,"day"),m=r(y).isSame(e.ItemMeg.time,"day");l&&n.forEach((v,F)=>{v.id===e.oldItemMeg.id&&n.splice(F,1)}),m&&n.filter(F=>F.id===e.ItemMeg.id).length===0&&n.unshift(e.ItemMeg)}});function V(e){console.log("carddate:",e);let t=r(e,"MM/DD-[星期]dd").unix()*1e3;a.state.carddate=t}function J(e){De.confirm({title:()=>`是否确认删除任务名为:"${e.title}"的事项?`,icon:()=>i(ye),onOk(){n.forEach((t,o)=>{t.id===e.id&&(a.actions.delItem(n[o],e),n.splice(o,1),G.success("已删除"),a.state.itemVisible=!1)})},onCancel(){}})}function j(e){const t=Date.now()-e,o=Math.floor(t/(24*60*60*1e3)),l=Math.floor(t/(60*60*1e3)%24),m=Math.floor(t/(60*1e3)%60);if(o>0||l>0||m>0)return o===0?l===0?m===0?"":`过期：${m}分钟`:`过期：${l}小时${m}分钟`:`过期：${o}天${l}小时${m}分钟`}return{BarsOutlined:W,data:n,drag:Y,checked:T,onStart:M,onEnd:b,listTop:$,itemTure:A,itemDel:U,liFalse:s,dbItem:O,inputShow:h,store:a,cardMsg:E,all:D,changeTime:H,changeItemTitle:S,extension:j,dleItem:J,inputRef:w,focus,showModal:p,loading:C,addItem:V}}}),Le={style:{color:"#1677FF",display:"inline-block"}},Te={style:{"font-size":"15px",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},Fe={style:{display:"block","font-size":"16px",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}};function Ne(u,a,k,f,y,n){const C=c("a-button"),D=c("PlusOutlined"),w=c("check-outlined"),S=c("a-switch"),E=c("a-list-item-meta"),L=c("a-list-item"),Y=c("a-tooltip"),T=c("CheckCircleOutlined"),h=c("CloseCircleOutlined"),M=c("a-menu-item"),b=c("EditOutlined"),p=c("DeleteOutlined"),$=c("a-menu"),H=c("a-dropdown"),A=c("a-list"),U=c("a-card");return q(),ce(U,{style:{width:"20vw","box-shadow":"0px 10px 10px 3px #F6F5F5","border-radius":"20px",height:"70vh",display:"inline-block",margin:"0 10px","white-space":"normal"},bodyStyle:`overflow: auto;height: 58vh;\r
                `},{title:d(()=>[x(i(C,{type:"primary",shape:"circle",style:{"margin-right":"10px"}},{default:d(()=>[P(N(u.toDay),1)]),_:1},512),[[I,u.toDay==="今"]]),_("h3",Le,N(u.carddate),1)]),extra:d(()=>[i(C,{type:"text",shape:"circle",onClick:a[0]||(a[0]=s=>u.addItem(u.carddate))},{default:d(()=>[i(D)]),_:1})]),default:d(()=>[i(ge,{name:"list"},{default:d(()=>[i(A,{"item-layout":"horizontal","data-source":u.data},{renderItem:d(({item:s})=>[i(H,{trigger:["contextmenu"]},{overlay:d(()=>[i($,null,{default:d(()=>[i(M,{key:"1",onClick:O=>(s.checked==!1?s.checked=!0:s.checked=!1,u.listTop(s))},{default:d(()=>[x(_("div",null,[i(T),P(" 完成 ")],512),[[I,!s.checked]]),x(_("div",null,[i(h),P(" 取消完成 ")],512),[[I,s.checked]])]),_:2},1032,["onClick"]),i(M,{key:"2",onClick:O=>u.dbItem(s,s.magName)},{default:d(()=>[i(b),P(" 编辑 ")]),_:2},1032,["onClick"]),i(M,{key:"3",style:{color:"#ee602c"},onClick:O=>u.dleItem(s)},{default:d(()=>[i(p),P(" 删除 ")]),_:2},1032,["onClick"])]),_:2},1024)]),default:d(()=>[_("div",null,[i(Y,{placement:"topLeft",title:`${s.magName}➖${s.title}`,mouseEnterDelay:1},{default:d(()=>[x(i(L,{onDblclick:O=>u.dbItem(s),class:"changeColor",style:{width:"100%",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},{default:d(()=>[i(E,{style:{width:"100%",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},{description:d(()=>[_("p",Te,N(u.changeTime(s.time,s.timeSlot)),1),x(_("p",{style:{overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}}," 备注："+N(s.massage),513),[[I,s.massage]]),x(_("p",{style:{color:"#6cb7f1",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}}," 完成时间:"+N(u.changeTime(s.timeTrue)),513),[[I,s.checked]]),x(_("p",{style:{color:"#f49657",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},N(u.extension(s.time)),513),[[I,!s.checked]])]),title:d(()=>[_("a",Fe,N(s.title),1)]),avatar:d(()=>[i(S,{style:re([{margin:"10px 0"},s.checked?"":"background-color: #EAEFFE"]),checked:s.checked,"onUpdate:checked":O=>s.checked=O,onClick:O=>u.listTop(s)},{checkedChildren:d(()=>[i(w)]),unCheckedChildren:d(()=>[]),_:2},1032,["checked","onUpdate:checked","onClick","style"])]),_:2},1024)]),_:2},1032,["onDblclick"]),[[I,u.store.state.wholeChecked===!0?!s.checked:s]])]),_:2},1032,["title"])])]),_:2},1024)]),_:1},8,["data-source"])]),_:1})]),_:1})}const $e=le(Ee,[["render",Ne]]);const ze={name:"tasklist",setup(){r.extend(ke),r.locale("zh-cn");const u=de(),a=g(r().format("MM/DD-dddd")),k=g(!1),f=g([]),y=g(r().format("YYYY-MM-DD")),n=r().subtract(3,"day"),C=r().add(3,"day"),D=[],w=z([]),S=g(),E=g(u.state.appSidersML),L=g();window.addEventListener("resize",Y);function Y(){L.value=window.innerWidth,ie(L.value)}B(()=>u.state.appSidersML,t=>{E.value=t});const T=r().format("MM/DD-dddd"),h=z({loading:!0,currentIndex:0,imgs:[]});for(let t=n;t<=C;t=t.add(1,"day"))t.format("MM/DD-dddd"),D.push(t.format("MM/DD-dddd"));w.push(...D);const M=g(null),b=g(3),p=g(),$=(t,o)=>{console.log(t,o)};async function H(){Ce(()=>{h.loading=!1})}function A(){let t=0;D.forEach(o=>{const l={id:o,uuid:Q(),index:t,item:[]};T===o&&(l.toDay="今"),h.imgs.push(l),t++})}A();function U(t){M.value.prev()}const s=t=>{if(w[3]!==h.imgs[t].id?k.value=!0:k.value=!1,a.value=h.imgs[t].id,t==2){let l=r(h.imgs[0].id,"MM/DD-dddd","zh-cn").valueOf();const v={id:r(l).subtract(1,"day").format("MM/DD-dddd"),uuid:Q(),index:h.imgs[0].index--,item:[]};b.value=3,h.imgs.unshift(v)}if(t==h.imgs.length-1){let l=r(h.imgs[h.imgs.length-1].id,"MM/DD-dddd","zh-cn").valueOf();const v={id:r(l).add(1,"day").format("MM/DD-dddd"),uuid:Q(),index:h.imgs[h.imgs.length-1].index++,item:[]};b.value=t,h.imgs.push(v)}};function O(){M.value.next()}u.actions.getChecked().then(t=>{S.value=t});function V(){u.actions.changeChecked(S.value)}function J(){y.value="0",setTimeout(()=>{y.value=r().format("YYYY-MM-DD")})}function j(){}function e(){}return B(y,t=>{if(t!==0){D.length=0,h.imgs.length=0;let l=r(t,"YYYY-MM-DD","zh-cn").valueOf(),m=r(l).format("MM/DD-dddd");w[3]===m?k.value=!1:k.value=!0;const v=r(l).subtract(3,"day"),F=r(l).add(3,"day");for(let R=v;R<=F;R=R.add(1,"day"))R.format("MM/DD-dddd"),D.push(R.format("MM/DD-dddd"));A(),b.value=3}}),{data:h,appSidersML:E,prev:U,next:O,getData:H,currentDate:y,onPanelChange:$,value:p,carousel:M,handleChange:s,currentIndex:b,sioncurrentDate:a,liFalse:V,checked:S,today:J,siontimedata:f,newDates:w,carouselPrev:j,changeDate:e,btnShow:k,changeAppSidersML:ie,state:Ie}},components:{LeftOutlined:Me,RightOutlined:ve,DailyCard:$e,MenuFoldOutlined:Se,MenuUnfoldOutlined:Ye}},Be={style:{"font-size":"1.5em"}},Pe={style:{width:"100%"}},Ae={class:"FBox"},He={class:"demo-date-picker"},Ue={class:"text"};function Re(u,a,k,f,y,n){const C=c("MenuFoldOutlined"),D=c("MenuUnfoldOutlined"),w=c("a-switch"),S=c("a-page-header"),E=c("DailyCard"),L=c("el-carousel-item"),Y=c("el-carousel"),T=c("LeftOutlined"),h=c("a-button"),M=c("el-date-picker"),b=c("RightOutlined");return q(),ae(ne,null,[_("div",null,[_("div",null,[i(S,{class:"demo-page-header",title:"事项-日程","sub-title":"点击卡片或按钮切换",onBack:a[1]||(a[1]=p=>f.changeAppSidersML())},{backIcon:d(()=>[_("div",Be,[x(i(C,null,null,512),[[I,f.appSidersML==!1]]),x(i(D,null,null,512),[[I,f.appSidersML==!0]])])]),extra:d(()=>[i(w,{onClick:f.liFalse,checked:f.checked,"onUpdate:checked":a[0]||(a[0]=p=>f.checked=p),style:re(f.checked?"":"background-color: #EAEFFE")},null,8,["onClick","checked","style"]),P("隐藏已完成 ")]),_:1})]),_("div",Pe,[i(Y,{ref:"carousel",onChange:f.handleChange,onPrev:f.carouselPrev,"initial-index":f.currentIndex,"indicator-position":"none",interval:4e3,type:"card",loop:!1,autoplay:!1,height:"75vh"},{default:d(()=>[(q(!0),ae(ne,null,we(f.data.imgs,p=>(q(),ce(L,{key:p.uuid},{default:d(()=>[i(E,{carddate:p.id,toDay:p.toDay,style:{width:"80%",height:"95%","margin-left":"10%"}},null,8,["carddate","toDay"])]),_:2},1024))),128))]),_:1},8,["onChange","onPrev","initial-index"])])]),_("div",Ae,[i(h,{shape:"circle",onClick:f.prev,style:{border:"none"}},{icon:d(()=>[i(T)]),_:1},8,["onClick"]),_("div",He,[i(M,{modelValue:f.currentDate,"onUpdate:modelValue":a[3]||(a[3]=p=>f.currentDate=p),type:"date",placeholder:"Pick a day",format:"YYYY/MM/DD","value-format":"YYYY-MM-DD",editable:!1,clearable:!1,style:{width:"120px",height:"40px"}},{default:d(p=>[_("div",{onClick:a[2]||(a[2]=(...$)=>f.changeDate&&f.changeDate(...$)),class:be(["cell",{current:p.isCurrent}])},[_("span",Ue,N(p.text),1)],2)]),_:1},8,["modelValue"])]),x(i(h,{type:"link",style:{width:"80px"},onClick:f.today},{default:d(()=>[P("回到今天")]),_:1},8,["onClick"]),[[I,f.btnShow]]),i(h,{shape:"circle",onClick:f.next,style:{border:"none"}},{icon:d(()=>[i(b)]),_:1},8,["onClick"])])],64)}const je=le(ze,[["render",Re]]);export{je as default};
