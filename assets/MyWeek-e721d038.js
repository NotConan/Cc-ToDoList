import{_ as le,a as ne,l as h,p as _,q as C,j as f,v as k,y as p,F as $,a1 as se,a2 as ie,h as ce,f as de,E as re,D as me,d,a0 as ue,u as fe,b as E,r as v,w as O,x as I,A as w,H as S,z as B,K as U,J as he,s as V,t as pe,m as X,M as De,k as ke}from"./index-ea1c0221.js";import{M as Ye,a as Me,g as ge,c as oe,s as _e,b as Z,d as Ee,e as Ce}from"./utils-61e8505b.js";const ye=ne({components:{LeftOutlined:se,RightOutlined:ie,PlusOutlined:ce,MenuFoldOutlined:Ye,MenuUnfoldOutlined:Me,CheckCircleOutlined:de,EditOutlined:re,DeleteOutlined:me},setup(){d.extend(ue),d.locale("zh-cn");const t=fe(),Y=E(null),ee=ge(),T=E(1),s=v([]),u=v([]),b=E(),F=E(t.state.wholeChecked),N=E(t.state.appSidersML),y=E(d().format("YYYY-MM-DD")),J=E(d().format("YYYY-MM-DD")),L=E(!1),z=E();window.addEventListener("resize",H);function H(){z.value=window.innerWidth,oe(z.value)}O(y,e=>{Z(e).filter(a=>a.formattedDate===J.value).length==0?L.value=!0:L.value=!1}),O(()=>t.state.appSidersML,e=>{N.value=e}),O(()=>t.state.wholeChecked,e=>{F.value=e}),ee.forEach((e,l)=>{const r=v([]);e.forEach(a=>{let o=Number(d(a.timestamp).format("DD")),n=d(a.timestamp).format("dddd");const i=d().format("YYYY-MM-DD");let c={id:a.formattedDate,time:o,weeks:n,today:!1,item:[]};i===a.formattedDate&&(c.today=!0),r.push(c)}),s.push(r)}),t.actions.getAllData().then(e=>{u.unshift(...e),u.forEach((l,r)=>{JSON.parse(u[r].allMes).magName,JSON.parse(u[r].allMes).item.forEach(o=>{let n=d(o.time).format("YYYY-MM-DD");s.forEach((i,c)=>{i.forEach((m,M)=>{m.id===n&&(o.checked===!1?i[M].item.unshift(o):i[M].item.push(o))})})})})}),t.actions.getChecked().then(e=>{b.value=e});function P(e){setTimeout(()=>{s.splice(0,s.length),u.splice(0,u.length);let l=d(y.value,"YYYY-MM-DD").unix()*1e3;const r=Z(l),a=v([]);r.forEach(o=>{let n=Number(d(o.timestamp).format("DD")),i=d(o.timestamp).format("dddd");const c=d().format("YYYY-MM-DD");let m={id:o.formattedDate,time:n,weeks:i,today:!1,item:[]};c===o.formattedDate&&(m.today=!0),a.push(m)}),s.push(a),y.value=a[0].id,t.actions.getAllData().then(o=>{u.unshift(...o),console.log("seesionData:",u),u.forEach((n,i)=>{JSON.parse(u[i].allMes).magName,JSON.parse(u[i].allMes).item.forEach(m=>{let M=d(m.time).format("YYYY-MM-DD");s.forEach((g,te)=>{g.forEach((A,ae)=>{A.id===M&&(m.checked===!1?g[ae].item.unshift(m):g[ae].item.push(m))})})})})})})}function j(){s.splice(0,s.length),u.splice(0,u.length);let e=d(J.value,"YYYY-MM-DD").unix()*1e3;const l=Z(e),r=v([]);l.forEach(a=>{let o=Number(d(a.timestamp).format("DD")),n=d(a.timestamp).format("dddd");const i=d().format("YYYY-MM-DD");let c={id:a.formattedDate,time:o,weeks:n,today:!1,item:[]};i===a.formattedDate&&(c.today=!0),r.push(c)}),s.push(r),t.actions.getAllData().then(a=>{u.unshift(...a),u.forEach((o,n)=>{JSON.parse(u[n].allMes).magName,JSON.parse(u[n].allMes).item.forEach(c=>{let m=d(c.time).format("YYYY-MM-DD");s.forEach((M,g)=>{M.forEach((te,A)=>{te.id===m&&(c.checked===!1?M[A].item.unshift(c):M[A].item.push(c))})})})})})}function W(){t.actions.changeChecked(b.value)}function x(e){return e.today}function R(e){return e.checked===!0}function q(e){if(y.value=s[e][0].id,e==0){const l=d(s[0][0].id).valueOf(),r=Ee(l),a=v([]);r.forEach(o=>{let n=Number(d(o.timestamp).format("DD")),i=d(o.timestamp).format("dddd");const c=d().format("YYYY-MM-DD");let m={id:o.formattedDate,time:n,weeks:i,today:!1,item:[]};c===o.formattedDate&&(m.today=!0),a.push(m)}),u.forEach((o,n)=>{JSON.parse(u[n].allMes).item.forEach(c=>{let m=d(c.time).format("YYYY-MM-DD");a.forEach((M,g)=>{M.id===m&&(c.checked===!1?a[g].item.unshift(c):a[g].item.push(c))})})}),s.unshift(a),T.value=1}if(e==s.length-1){const l=d(s[s.length-1][0].id).valueOf(),r=Ce(l),a=v([]);r.forEach(o=>{let n=Number(d(o.timestamp).format("DD")),i=d(o.timestamp).format("dddd");const c=d().format("YYYY-MM-DD");let m={id:o.formattedDate,time:n,weeks:i,today:!1,item:[]};c===o.formattedDate&&(m.today=!0),a.push(m)}),u.forEach((o,n)=>{JSON.parse(u[n].allMes).item.forEach(c=>{let m=d(c.time).format("YYYY-MM-DD");a.forEach((M,g)=>{M.id===m&&(c.checked===!1?a[g].item.unshift(c):a[g].item.push(c))})})}),T.value=e,s.push(a)}}function K(e){let l=d(e,"YYYY-MM-DD").unix()*1e3;t.state.carddate=l}function G(e){t.state.itemVisible=!0,t.state.ListMagName=e.magName,t.state.doubleClickItem=e}async function Q(e){let l=0;e.checked===!0?s.forEach((r,a)=>{r.forEach((o,n)=>{o.item.forEach((i,c)=>{if(i.id===e.id)throw t.actions.putItemChecked(i,e),s[a][n].item.splice(c,1),e.timeTrue=Date.now(),s[a][n].item.push(e),s[a][n].item.forEach(m=>{m.checked===!1&&l++}),l?X.success(`Nice！！！${o.id}只剩${l}项待办事件啦！加油加油！`):X.success(`耶！关于${o.id}的任务全部完成咯！！！`)})})}):s.forEach((r,a)=>{r.forEach((o,n)=>{o.item.forEach((i,c)=>{i.id===e.id&&(t.actions.putItemChecked(i,e),s[a][n].item.splice(c,1),s[a][n].item.unshift(e))})})})}function D(e){De.confirm({title:()=>`是否确认删除任务名为:"${e.title}"的事项?`,icon:()=>f(ke),onOk(){s.forEach((l,r)=>{l.forEach((a,o)=>{a.item.forEach((n,i)=>{n.id===e.id&&(console.log("iss:",n.magName),t.actions.delItem(n,e),s[r][o].item.splice(i,1),X.success("已删除"),t.state.itemVisible=!1)})})})},onCancel(){}})}return O(t.state.sionData,e=>{t.state.sionData.length!==0&&s.forEach((l,r)=>{l.forEach((a,o)=>{let n=d(a.id,"YYYY-MM-DD").unix()*1e3;d(n).isSame(e[1].time,"day")&&s[r][o].item.unshift(e[1])})}),t.state.sionData.splice(0,t.state.sionData.length)}),O(()=>t.state.BtndelItem,e=>{s.forEach((l,r)=>{l.forEach((a,o)=>{let n=d(a.id,"YYYY-MM-DD").unix()*1e3;d(n).isSame(e.time,"day")&&D(e)})})}),O(t.state.sionListValue,e=>{s.forEach((l,r)=>{l.forEach((a,o)=>{a.item.forEach((n,i)=>{n.id===e.cardItem.id&&(s[r][o].item[i].magName=e.sionList,console.log("newValue:",e),t.actions.changeListItem(e))})})})}),O(t.state.timeValue,e=>{let l=d(e.oldtimeValue).format("YYYY-MM-DD"),r=d(e.siontimeValue).format("YYYY-MM-DD");s.forEach((a,o)=>{a.forEach((n,i)=>{n.id===l&&n.item.forEach((c,m)=>{c.id===e.cardItem.id&&s[o][i].item.splice(m,1)}),n.id===r&&s[o][i].item.filter(m=>m.id===e.cardItem.id).length===0&&s[o][i].item.unshift(e.cardItem)})})}),{isHighlighted:x,liColor:R,state:_e,changeAppSidersML:oe,data:s,carousel:Y,carouselChange:q,initialIndex:T,liFalse:W,checked:b,checkedLi:F,addItem:K,dbItem:G,listTop:Q,dleItem:D,appSidersML:N,currentDate:y,changeDate:P,toDay:j,toDayShow:L}}}),ve={style:{"font-size":"1.5em"}},Oe={class:"text"},Ie={class:"show"},we={class:"box"},Se={class:"time"},be=["onDblclick"];function Ne(t,Y,ee,T,s,u){const b=h("MenuFoldOutlined"),F=h("MenuUnfoldOutlined"),N=h("a-button"),y=h("el-date-picker"),J=h("a-switch"),L=h("a-page-header"),z=h("PlusOutlined"),H=h("a-tooltip"),P=h("CheckCircleOutlined"),j=h("CloseCircleOutlined"),W=h("a-menu-item"),x=h("EditOutlined"),R=h("DeleteOutlined"),q=h("a-menu"),K=h("a-dropdown"),G=h("el-carousel-item"),Q=h("el-carousel");return _(),C($,null,[f(L,{title:"我的一周","sub-title":"可查看任意一周",onBack:Y[4]||(Y[4]=D=>t.changeAppSidersML())},{backIcon:k(()=>[p("div",ve,[I(f(b,null,null,512),[[w,t.appSidersML==!1]]),I(f(F,null,null,512),[[w,t.appSidersML==!0]])])]),extra:k(()=>[I(f(N,{type:"primary",onClick:Y[0]||(Y[0]=D=>t.toDay())},{default:k(()=>[S("本周")]),_:1},512),[[w,t.toDayShow]]),f(y,{modelValue:t.currentDate,"onUpdate:modelValue":Y[2]||(Y[2]=D=>t.currentDate=D),type:"date",placeholder:"Pick a day",format:"YY/MM","value-format":"YYYY-MM-DD",editable:!1,clearable:!1,style:{width:"120px",height:"40px",margin:"0 25px 0 0","box-shadow":"none","font-size":"25px"}},{default:k(D=>[p("div",{onClick:Y[1]||(Y[1]=e=>t.changeDate(t.currentDate)),class:U(["cell",{current:D.isCurrent}])},[p("span",Oe,B(D.text),1)],2)]),_:1},8,["modelValue"]),f(J,{onClick:t.liFalse,checked:t.checked,"onUpdate:checked":Y[3]||(Y[3]=D=>t.checked=D),style:he(t.checked?"":"background-color: #EAEFFE")},null,8,["onClick","checked","style"]),S("隐藏已完成 ")]),_:1}),p("div",Ie,[p("div",we,[p("div",Se,[f(Q,{ref:"carousel",onChange:t.carouselChange,loop:!1,"initial-index":t.initialIndex,"indicator-position":"none",autoplay:!1,height:"70vh"},{default:k(()=>[(_(!0),C($,null,V(t.data,D=>(_(),pe(G,{key:D},{default:k(()=>[p("table",null,[p("thead",null,[p("tr",null,[(_(!0),C($,null,V(D,e=>(_(),C("td",{key:e.id},[p("h2",{class:U({text:t.isHighlighted(e)})},B(e.time),3),p("p",{class:U({text:t.isHighlighted(e)})},B(e.weeks),3),f(N,{type:"text",onClick:l=>t.addItem(e.id)},{icon:k(()=>[f(z)]),_:2},1032,["onClick"])]))),128))])]),p("tbody",null,[p("tr",null,[(_(!0),C($,null,V(D,e=>(_(),C("td",{key:e.id},[p("ul",null,[(_(!0),C($,null,V(e.item,l=>(_(),C("div",null,[f(K,{trigger:["contextmenu"]},{overlay:k(()=>[f(q,null,{default:k(()=>[f(W,{key:"1",onClick:r=>(l.checked==!1?l.checked=!0:l.checked=!1,t.listTop(l))},{default:k(()=>[I(p("div",null,[f(P),S(" 完成 ")],512),[[w,!l.checked]]),I(p("div",null,[f(j),S(" 取消完成 ")],512),[[w,l.checked]])]),_:2},1032,["onClick"]),f(W,{key:"2",onClick:r=>t.dbItem(l,l.magName)},{default:k(()=>[f(x),S(" 编辑 ")]),_:2},1032,["onClick"]),f(W,{key:"3",style:{color:"#ee602c"},onClick:r=>t.dleItem(l)},{default:k(()=>[f(R),S(" 删除 ")]),_:2},1032,["onClick"])]),_:2},1024)]),default:k(()=>[f(H,{placement:"topLeft",title:`${l.magName}➖${l.title}`,mouseEnterDelay:1},{default:k(()=>[I(p("li",{class:U({liColor:t.liColor(l)}),onDblclick:r=>t.dbItem(l)},B(l.title),43,be),[[w,t.checkedLi===!0?!l.checked:l]])]),_:2},1032,["title"])]),_:2},1024)]))),256))])]))),128))])])])]),_:2},1024))),128))]),_:1},8,["onChange","initial-index"])])])])],64)}const $e=le(ye,[["render",Ne],["__scopeId","data-v-befee96f"]]);export{$e as default};
